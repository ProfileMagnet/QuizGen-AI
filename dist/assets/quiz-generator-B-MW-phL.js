var W=Object.defineProperty,U=Object.defineProperties;var Y=Object.getOwnPropertyDescriptors;var $=Object.getOwnPropertySymbols;var B=Object.prototype.hasOwnProperty,J=Object.prototype.propertyIsEnumerable;var q=(i,s,a)=>s in i?W(i,s,{enumerable:!0,configurable:!0,writable:!0,value:a}):i[s]=a,I=(i,s)=>{for(var a in s||(s={}))B.call(s,a)&&q(i,a,s[a]);if($)for(var a of $(s))J.call(s,a)&&q(i,a,s[a]);return i},T=(i,s)=>U(i,Y(s));var E=(i,s,a)=>new Promise((b,n)=>{var h=x=>{try{w(a.next(x))}catch(m){n(m)}},u=x=>{try{w(a.throw(x))}catch(m){n(m)}},w=x=>x.done?b(x.value):Promise.resolve(x.value).then(h,u);w((a=a.apply(i,s)).next())});import{r as N,j as e,b as V,S as Q,c as X,D as Z}from"./react-vendor-W4zfnjO4.js";import{L as ee,C as te,I as se}from"./components-M3VO9Bd-.js";import{E as ne}from"./pdf-vendor-BewEnL2H.js";import"./vendor-k7V_0J0F.js";const re=i=>{const s=new ne,a=s.internal.pageSize.getWidth(),b=s.internal.pageSize.getHeight();let n=15;const h=15,u=a-h*2,w=5,x=4,m=(c,j,p,f,S=12)=>{s.setFontSize(S);const k=s.splitTextToSize(c,f);return s.text(k,j,p),p+k.length*w+2},l=c=>n+c>b-h?(s.addPage(),n=15,!0):!1;i.forEach(c=>{const j=30+c.options.length*10;l(j),s.setFontSize(11),s.setFont("helvetica","bold");const p=`${c.id}. ${c.question}`;n=m(p,h,n,u,11),n+=1,s.setFontSize(9),s.setFont("helvetica","normal"),c.options.forEach((f,S)=>{const C=`${String.fromCharCode(65+S)}) ${f}`;n=m(C,h+8,n,u-8,9)}),n+=x}),s.addPage(),n=15,s.setFontSize(16),s.setFont("helvetica","bold"),n=m("Answer Key",h,n,u,16),n+=10,s.setFontSize(11),s.setFont("helvetica","normal"),i.forEach(c=>{const j=String.fromCharCode(65+c.correctAnswer),p=`${c.id}. ${j}`;n=m(p,h,n,u,11),n+=2});const z=b-10;s.setFontSize(8),s.setFont("helvetica","italic"),s.text("QuizGen AI",h,z),s.text(new Date().toLocaleDateString(),a-h-30,z);const d=`quiz-${new Date().toISOString().split("T")[0]}.pdf`;s.save(d)},de=()=>{const[i,s]=N.useState(""),[a,b]=N.useState(""),[n,h]=N.useState([]),[u,w]=N.useState(!1),[x,m]=N.useState(!1),[l,z]=N.useState({}),[d,c]=N.useState("practice"),[j,p]=N.useState(0),[f]=N.useState(5),S=(t=!1)=>E(null,null,function*(){if(!i.trim()||!a.trim()){alert("Please provide both topic and Hugging Face API key");return}w(!0);try{console.log("Making API request with:",{text:`Generate a quiz about: ${i}`,api_key:a.substring(0,10)+"..."});const r=yield fetch("https://quiz-generator-from-text.onrender.com/create_quiz/",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({text:`Generate a quiz about: ${i}`,api_key:a})});if(console.log("Response status:",r.status),console.log("Response headers:",r.headers),!r.ok){const g=yield r.text();throw console.error("Error response:",g),new Error(g||`Request failed with status ${r.status}`)}const o=yield r.json();if(console.log("API Response:",o),!o.quiz||!Array.isArray(o.quiz))throw console.error("Unexpected response format:",o),new Error("Invalid response format from API");const v=o.quiz.map((g,y)=>({id:t?n.length+y+1:y+1,question:g.question,options:g.options,correctAnswer:g.answer_index}));console.log("Normalized questions:",v),t?(h(g=>[...g,...v]),m(!0)):(h(v),p(0),z({}),c("practice"),m(!0))}catch(r){console.error("Full error:",r),alert(`Failed to generate quiz: ${r instanceof Error?r.message:"Unknown error"}`)}finally{w(!1)}}),k=()=>{s(""),b(""),h([]),z({}),c("practice"),p(0),m(!1)},C=()=>{S(!0)},R=(t,r)=>{d!=="review"&&z(o=>T(I({},o),{[t]:r}))},H=()=>{d!=="review"&&(z({}),p(0))},D=()=>{n.length!==0&&re(n)},M=(t,r)=>{const o=l[t],v=n.find(g=>g.id===t);return!v||o===void 0?"default":r===v.correctAnswer?"correct":r===o?"incorrect":"default"},F=()=>{const t=n.filter(r=>l[r.id]===r.correctAnswer).length;return{correct:t,total:n.length,percentage:Math.round(t/n.length*100)}},A=()=>{const t=j*f,r=t+f;return n.slice(t,r)},G=()=>Math.ceil(n.length/f),O=()=>A().filter(r=>l[r.id]!==void 0).length,K=()=>{const t=A();return t.length>0&&t.every(r=>l[r.id]!==void 0)},L=n.length>0&&n.every(t=>l[t.id]!==void 0),P=()=>j<G()-1,_=()=>j>0;return e.jsxs("div",{className:"quiz-generator-page",children:[u&&e.jsx(ee,{message:"Generating your quiz..."}),x&&e.jsx(te,{onComplete:()=>m(!1),duration:4e3}),e.jsxs("div",{className:"container",children:[e.jsxs("div",{className:"quiz-header",children:[e.jsxs("button",{className:"back-button",onClick:()=>window.history.back(),children:[e.jsx(V,{size:20}),"Home"]}),e.jsx("div",{className:"quiz-header-content",children:e.jsxs("h1",{className:"page-title",children:[e.jsx("img",{src:"/icon.png",alt:"QuizGen AI",className:"title-icon"}),"QuizGen AI"]})})]}),n.length===0?e.jsx("div",{className:"generator-form",children:e.jsxs("div",{className:"form-card",children:[e.jsx("h2",{children:"Create Your Quiz"}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"topic",children:"Topic"}),e.jsx("input",{type:"text",id:"topic",placeholder:"Enter a topic (e.g., JavaScript, History, Biology)",value:i,onChange:t=>s(t.target.value)})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"apiKey",children:"Hugging Face API Key"}),e.jsx("input",{type:"password",id:"apiKey",placeholder:"Enter your Hugging Face API key",value:a,onChange:t=>b(t.target.value)}),e.jsxs("small",{className:"form-help",children:["Get your API key from ",e.jsx("a",{href:"https://huggingface.co/settings/tokens",target:"_blank",rel:"noopener noreferrer",children:"Hugging Face Settings"})]})]}),e.jsx("button",{className:"generate-button",onClick:()=>S(!1),disabled:u||!i.trim()||!a.trim(),children:u?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"spinner"}),"Generating Quiz"]}):e.jsxs(e.Fragment,{children:[e.jsx(Q,{size:20}),"Generate Quiz"]})})]})}):e.jsxs("div",{className:"quiz-results-container",children:[e.jsxs("div",{className:"quiz-results",children:[e.jsxs("div",{className:"results-header",children:[e.jsx("div",{className:"quiz-title-section",children:e.jsx("div",{className:`step-indicator ${d==="review"?"review-mode":""}`,children:d==="review"?e.jsxs(e.Fragment,{children:["All Questions Review",e.jsxs("span",{className:"step-progress",children:["(",Object.keys(l).length,"/",n.length," answered)"]})]}):e.jsxs(e.Fragment,{children:["Step ",j+1," of ",G(),e.jsxs("span",{className:"step-progress",children:["(",O(),"/",A().length," answered)"]})]})})}),e.jsxs("div",{className:"header-actions",children:[d==="practice"&&L&&e.jsx("button",{className:"review-button",onClick:()=>c("review"),children:"Review All Answers"}),d==="review"&&e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"review-button",onClick:()=>c("practice"),children:"Back to Practice"}),e.jsxs("div",{className:"score-display",children:["Score: ",F().correct,"/",F().total," (",F().percentage,"%)"]})]}),d==="practice"&&Object.keys(l).length>0&&e.jsxs("button",{className:"reset-all-button",onClick:H,title:"Reset all answers",children:[e.jsx(X,{size:16}),"Reset Answers"]}),e.jsx("button",{className:"generate-more-button",onClick:C,disabled:u,children:u?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"spinner"}),"Generating..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Q,{size:18}),"Generate More"]})}),e.jsx("button",{className:"reset-button",onClick:k,children:"Create New Quiz"})]})]}),d==="practice"&&e.jsxs("div",{className:"step-navigation",children:[e.jsx("button",{className:"nav-button prev",onClick:()=>p(t=>t-1),disabled:!_(),children:"â† Previous"}),e.jsx("div",{className:"step-dots",children:Array.from({length:G()},(t,r)=>e.jsx("button",{className:`step-dot ${r===j?"active":""} ${n.slice(r*f,(r+1)*f).every(o=>l[o.id]!==void 0)?"completed":""}`,onClick:()=>p(r),children:r+1},r))}),e.jsx("button",{className:"nav-button next",onClick:()=>p(t=>t+1),disabled:!P(),children:"Next â†’"})]}),e.jsx("div",{className:"quiz-questions",children:(d==="practice"?A():n).map(t=>e.jsxs("div",{className:"quiz-question-card",children:[e.jsxs("div",{className:"question-header",children:[e.jsx("span",{className:"question-number",children:t.id}),e.jsx("h3",{children:t.question})]}),e.jsx("div",{className:"question-options",children:t.options.map((r,o)=>{const v=M(t.id,o),g=l[t.id]===o,y=l[t.id]!==void 0;return e.jsxs("div",{className:`option ${v!=="default"?`option-${v}`:""} ${g?"selected":""} ${d==="practice"?"clickable":""}`,onClick:()=>R(t.id,o),children:[e.jsxs("span",{className:"option-letter",children:[String.fromCharCode(65+o),"."]}),e.jsx("span",{className:"option-text",children:r}),y&&d==="review"&&e.jsxs(e.Fragment,{children:[v==="correct"&&e.jsx("span",{className:"feedback-icon correct",children:"âœ“"}),v==="incorrect"&&e.jsx("span",{className:"feedback-icon incorrect",children:"âœ—"})]})]},o)})}),l[t.id]!==void 0&&d==="practice"&&e.jsx("div",{className:"instant-feedback",children:l[t.id]===t.correctAnswer?e.jsxs("div",{className:"feedback correct-feedback",children:[e.jsx("span",{className:"feedback-icon",children:"âœ“"}),"Correct! Well done."]}):e.jsxs("div",{className:"feedback incorrect-feedback",children:[e.jsxs("div",{className:"feedback-content",children:[e.jsx("span",{className:"feedback-icon",children:"âœ—"}),e.jsx("span",{children:"Incorrect. The correct answer is:"})]}),e.jsxs("strong",{children:[String.fromCharCode(65+t.correctAnswer),". ",t.options[t.correctAnswer]]})]})})]},t.id))}),d==="practice"&&K()&&P()&&e.jsxs("div",{className:"step-completion",children:[e.jsxs("div",{className:"completion-message",children:[e.jsx("span",{className:"completion-icon",children:"ðŸŽ‰"}),"Great job! You've completed this set of questions."]}),e.jsx("button",{className:"next-step-button",onClick:()=>p(t=>t+1),children:"Continue to Next Set â†’"})]}),e.jsxs("div",{className:"actions",children:[e.jsxs("button",{className:"btn btn-secondary",onClick:D,title:"Export quiz with correct answers",children:[e.jsx(Z,{size:18}),"Export Quiz"]}),e.jsx("button",{className:"generate-more-button",onClick:C,disabled:u,children:u?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"spinner"}),"Generating..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Q,{size:18}),"Generate More"]})})]})]}),e.jsx(se,{questions:n,userAnswers:l,isVisible:n.length>0})]})]})]})};export{de as default};
