const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/pdf-vendor-0xZnGuKI.js","assets/components-DwypGoE6.js","assets/react-vendor-OyjZooll.js","assets/vendor-CQqsF22v.js","assets/components-Bh9Sije7.css"])))=>i.map(i=>d[i]);
var de=Object.defineProperty,ue=Object.defineProperties;var he=Object.getOwnPropertyDescriptors;var U=Object.getOwnPropertySymbols;var me=Object.prototype.hasOwnProperty,pe=Object.prototype.propertyIsEnumerable;var W=(i,c,s)=>c in i?de(i,c,{enumerable:!0,configurable:!0,writable:!0,value:s}):i[c]=s,Y=(i,c)=>{for(var s in c||(c={}))me.call(c,s)&&W(i,s,c[s]);if(U)for(var s of U(c))pe.call(c,s)&&W(i,s,c[s]);return i},B=(i,c)=>ue(i,he(c));var E=(i,c,s)=>new Promise((z,N)=>{var o=d=>{try{p(s.next(d))}catch(x){N(x)}},r=d=>{try{p(s.throw(d))}catch(x){N(x)}},p=d=>d.done?z(d.value):Promise.resolve(d.value).then(o,r);p((s=s.apply(i,c)).next())});import{r as l,j as e,b as ge,c as xe,S as K,d as fe,D as ve}from"./react-vendor-OyjZooll.js";import{_ as je,C as ye,L as we,a as be,I as Ne}from"./components-DwypGoE6.js";import"./vendor-CQqsF22v.js";const ke=i=>E(null,null,function*(){const{default:c}=yield je(()=>E(null,null,function*(){const{default:a}=yield import("./pdf-vendor-0xZnGuKI.js");return{default:a}}),__vite__mapDeps([0,1,2,3,4])),s=new c,z=s.internal.pageSize.getWidth(),N=s.internal.pageSize.getHeight();let o=15;const r=15,p=z-r*2,d=5,x=4,C=(a,j,g,f,k=12)=>{s.setFontSize(k);const I=s.splitTextToSize(a,f);return s.text(I,j,g),g+I.length*d+2},P=a=>o+a>N-r?(s.addPage(),o=15,!0):!1;i.forEach(a=>{const j=30+a.options.length*10;P(j),s.setFontSize(11),s.setFont("helvetica","bold");const g=`${a.id}. ${a.question}`;o=C(g,r,o,p,11),o+=1,s.setFontSize(9),s.setFont("helvetica","normal"),a.options.forEach((f,k)=>{const A=`${String.fromCharCode(65+k)}) ${f}`;o=C(A,r+8,o,p-8,9)}),o+=x}),s.addPage(),o=15,s.setFontSize(16),s.setFont("helvetica","bold"),o=C("Answer Key",r,o,p,16),o+=10,s.setFontSize(11),s.setFont("helvetica","normal"),i.forEach(a=>{const j=String.fromCharCode(65+a.correctAnswer),g=`${a.id}. ${j}`;o=C(g,r,o,p,11),o+=2});const u=N-10;s.setFontSize(8),s.setFont("helvetica","italic"),s.text("QuizGen AI",r,u),s.text(new Date().toLocaleDateString(),z-r-30,u);const F=`quiz-${new Date().toISOString().split("T")[0]}.pdf`;s.save(F)}),Pe=()=>{const[i,c]=l.useState(""),[s,z]=l.useState(""),[N,o]=l.useState("Medium"),[r,p]=l.useState([]),[d,x]=l.useState(!1),[C,P]=l.useState(!1),[u,F]=l.useState({}),[a,j]=l.useState("practice"),[g,f]=l.useState(0),[k]=l.useState(5),[I,A]=l.useState(!1),[y,q]=l.useState(""),[V,T]=l.useState(""),[L,S]=l.useState(0),Q=l.useRef(null),D=l.useMemo(()=>r.map(t=>t.question),[r]);l.useEffect(()=>{const t=localStorage.getItem("quizgen-api-key");t&&z(t)},[]);const R=l.useCallback((t=!1)=>E(null,null,function*(){if(!i.trim()||!s.trim()){alert("Please provide both topic and Hugging Face API key");return}localStorage.setItem("quizgen-api-key",s),x(!0),Q.current&&Q.current.abort(),Q.current=new AbortController;try{console.log("Making API request with:",{text:`Generate a quiz about: ${i}`,level:N.toLowerCase(),past_quiz_qns:D,api_key:s.substring(0,10)+"..."});const n=new Promise((b,_)=>{setTimeout(()=>{_(new Error("Request timeout after 60 seconds"))},6e4)}),m=fetch("https://quiz-generator-from-text.onrender.com/create_quiz/",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},signal:Q.current.signal,body:JSON.stringify({text:`Generate a quiz about: ${i}`,level:N.toLowerCase(),past_quiz_qns:D,api_key:s})}),h=yield Promise.race([m,n]);if(console.log("Response status:",h.status),console.log("Response headers:",h.headers),!h.ok){const b=yield h.text();throw console.error("Error response:",b),h.status===401||h.status===403||b.includes("Unauthorized")?new Error("Invalid API key. Please check your Hugging Face API key and try again."):h.status===429?new Error("Rate limit exceeded. Please wait a moment and try again."):new Error(b||`Request failed with status ${h.status}`)}const v=yield h.json();if(console.log("API Response:",v),!v.quiz||!Array.isArray(v.quiz))throw console.error("Unexpected response format:",v),new Error("Invalid response format from API");const w=v.quiz.map((b,_)=>({id:t?r.length+_+1:_+1,question:b.question,options:b.options,correctAnswer:b.answer_index}));console.log("Normalized questions:",w),t?(p(b=>[...b,...w]),P(!0)):(p(w),f(0),F({}),j("practice"),P(!0)),S(0)}catch(n){if(console.error("Full error:",n),n instanceof Error&&n.name==="AbortError"){console.log("Request was aborted");return}if(n instanceof Error&&n.message==="Request timeout after 60 seconds"){if(L===0){console.log("First timeout, auto retrying..."),S(1);return}else q("Server Unresponsive"),T("The server appears to be down or taking too long to respond. Please try again later."),A(!0),S(0);x(!1);return}if(n instanceof Error&&(n.message.includes("Invalid API key")||n.message.includes("Unauthorized"))){q("Invalid API Key"),T("The provided Hugging Face API key is invalid or unauthorized. Please check your key and try again."),A(!0),S(0),x(!1);return}if(n instanceof Error&&n.message.includes("Rate limit exceeded")){q("Rate Limit Exceeded"),T("You have exceeded the rate limit. Please wait a moment and try again."),A(!0),S(0),x(!1);return}q("Error Generating Quiz"),T(n instanceof Error?n.message:"An unexpected error occurred. Please try again."),A(!0),S(0)}finally{x(!1)}}),[i,s,r,L,D]),J=l.useCallback(()=>{console.log("Auto retry triggered"),R(!1)},[R]),X=()=>{A(!1),y!=="Invalid API Key"&&y!=="Rate Limit Exceeded"&&R(!1)},Z=()=>{A(!1),S(0)},ee=()=>{c(""),o("Medium"),p([]),F({}),j("practice"),f(0),P(!1)},te=()=>{localStorage.removeItem("quizgen-api-key"),z("")},M=()=>{R(!0)},se=(t,n)=>{a!=="review"&&u[t]===void 0&&F(m=>B(Y({},m),{[t]:n}))},ne=()=>{if(a==="review")return;window.confirm("Are you sure you want to reset all your answers? This action cannot be undone.")&&(F({}),f(0))},re=()=>E(null,null,function*(){if(r.length!==0)try{yield ke(r)}catch(t){console.error("Failed to export PDF:",t)}}),ae=(t,n)=>{const m=u[t],h=r.find(v=>v.id===t);return!h||m===void 0?"default":n===h.correctAnswer?"correct":n===m?"incorrect":"default"},$=()=>{const t=r.filter(n=>u[n.id]===n.correctAnswer).length;return{correct:t,total:r.length,percentage:Math.round(t/r.length*100)}},G=()=>{const t=g*k,n=t+k;return r.slice(t,n)},H=()=>Math.ceil(r.length/k),ie=()=>G().filter(n=>u[n.id]!==void 0).length,oe=()=>{const t=G();return t.length>0&&t.every(n=>u[n.id]!==void 0)},ce=r.length>0&&r.every(t=>u[t.id]!==void 0),O=()=>g<H()-1,le=()=>g>0;return e.jsxs("div",{className:"quiz-generator-page",children:[e.jsx(ye,{isOpen:I,title:y,message:V,onRetry:X,onCancel:Z,retryText:y==="Invalid API Key"?"OK":"Retry",showRetry:y!=="Invalid API Key"&&y!=="Server Unresponsive",showCancel:!0,type:y==="Invalid API Key"||y==="Rate Limit Exceeded"?"error":y==="Request Taking Longer Than Expected"||y==="Server Unresponsive"?"warning":"info"}),d&&e.jsx(we,{message:"Generating your quiz...",onTimeout:J}),C&&e.jsx(be,{onComplete:()=>P(!1),duration:4e3}),e.jsxs("div",{className:"container",children:[e.jsxs("div",{className:"quiz-header",children:[e.jsxs("button",{className:"back-button",onClick:()=>window.history.back(),children:[e.jsx(ge,{size:20}),"Home"]}),e.jsx("div",{className:"quiz-header-content",children:e.jsxs("h1",{className:"page-title",children:[e.jsx("img",{src:"/icon.png",alt:"QuizGen AI",className:"title-icon"}),"QuizGen AI"]})})]}),r.length===0?e.jsx("div",{className:"generator-form",children:e.jsxs("div",{className:"form-card",children:[e.jsx("h2",{children:"Create Your Quiz"}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"topic",children:"Topic"}),e.jsx("input",{type:"text",id:"topic",placeholder:"Enter a topic (e.g., JavaScript, History, Biology)",value:i,onChange:t=>c(t.target.value)})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"difficulty",children:"Difficulty Level"}),e.jsxs("select",{id:"difficulty",value:N,onChange:t=>o(t.target.value),className:"difficulty-select",children:[e.jsx("option",{value:"Easy",children:"Easy"}),e.jsx("option",{value:"Medium",children:"Medium"}),e.jsx("option",{value:"Hard",children:"Hard"})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"apiKey",children:"Hugging Face API Key"}),e.jsxs("div",{className:"api-key-container",children:[e.jsx("input",{type:"password",id:"apiKey",placeholder:"Enter your Hugging Face API key",value:s,onChange:t=>z(t.target.value)}),s&&e.jsx("button",{type:"button",className:"clear-api-key-button",onClick:te,title:"Clear saved API key",children:"Clear"})]}),e.jsxs("div",{className:"form-help-container",children:[e.jsxs("small",{className:"form-help",children:["Get your API key from ",e.jsx("a",{href:"https://huggingface.co/settings/tokens",target:"_blank",rel:"noopener noreferrer",children:"Hugging Face Settings"})]}),e.jsxs("a",{href:"/documentation",className:"documentation-link",children:[e.jsx(xe,{size:16}),"Need help? View our interactive guide"]})]})]}),e.jsx("button",{className:"generate-button",onClick:()=>R(!1),disabled:d||!i.trim()||!s.trim(),children:d?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"spinner"}),"Generating Quiz"]}):e.jsxs(e.Fragment,{children:[e.jsx(K,{size:20}),"Generate Quiz"]})})]})}):e.jsxs("div",{className:"quiz-results-container",children:[e.jsxs("div",{className:"quiz-results",children:[e.jsxs("div",{className:"results-header",children:[e.jsx("div",{className:"quiz-title-section",children:e.jsx("div",{className:`step-indicator ${a==="review"?"review-mode":""}`,children:a==="review"?e.jsxs(e.Fragment,{children:["All Questions Review",e.jsxs("span",{className:"step-progress",children:["(",Object.keys(u).length,"/",r.length," answered)"]})]}):e.jsxs(e.Fragment,{children:["Step ",g+1," of ",H(),e.jsxs("span",{className:"step-progress",children:["(",ie(),"/",G().length," answered)"]})]})})}),e.jsxs("div",{className:"header-actions",children:[a==="practice"&&ce&&e.jsx("button",{className:"review-button",onClick:()=>j("review"),children:"Review All Answers"}),a==="review"&&e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"review-button",onClick:()=>j("practice"),children:"Back to Practice"}),e.jsxs("div",{className:"score-display",children:["Score: ",$().correct,"/",$().total," (",$().percentage,"%)"]})]}),a==="practice"&&Object.keys(u).length>0&&e.jsxs("button",{className:"reset-all-button",onClick:ne,title:"Reset all answers",children:[e.jsx(fe,{size:16}),"Reset Answers"]}),e.jsx("button",{className:"generate-more-button",onClick:M,disabled:d,children:d?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"spinner"}),"Generating..."]}):e.jsxs(e.Fragment,{children:[e.jsx(K,{size:18}),"Generate More"]})}),e.jsx("button",{className:"reset-button",onClick:ee,children:"Create New Quiz"})]})]}),a==="practice"&&e.jsxs("div",{className:"step-navigation",children:[e.jsx("button",{className:"nav-button prev",onClick:()=>f(t=>t-1),disabled:!le(),children:"â† Previous"}),e.jsx("div",{className:"step-dots",children:Array.from({length:H()},(t,n)=>e.jsx("button",{className:`step-dot ${n===g?"active":""} ${r.slice(n*k,(n+1)*k).every(m=>u[m.id]!==void 0)?"completed":""}`,onClick:()=>f(n),children:n+1},n))}),e.jsx("button",{className:"nav-button next",onClick:()=>f(t=>t+1),disabled:!O(),children:"Next â†’"})]}),e.jsx("div",{className:"quiz-questions",children:(a==="practice"?G():r).map(t=>e.jsxs("div",{className:"quiz-question-card",children:[e.jsxs("div",{className:"question-header",children:[e.jsx("span",{className:"question-number",children:t.id}),e.jsx("h3",{children:t.question})]}),e.jsx("div",{className:"question-options",children:t.options.map((n,m)=>{const h=ae(t.id,m),v=u[t.id]===m,w=u[t.id]!==void 0;return e.jsxs("div",{className:`option ${h!=="default"?`option-${h}`:""} ${v?"selected":""} ${a==="practice"&&!w?"clickable":""} ${w?"disabled":""}`,onClick:()=>se(t.id,m),style:{cursor:a==="practice"&&!w?"pointer":"not-allowed",opacity:a==="practice"&&w&&!v?.6:1},children:[e.jsxs("span",{className:"option-letter",children:[String.fromCharCode(65+m),"."]}),e.jsx("span",{className:"option-text",children:n}),w&&a==="practice"&&v&&e.jsx("span",{className:"lock-indicator",title:"Answer locked - use Reset to change",children:"ðŸ”’"}),w&&a==="review"&&e.jsxs(e.Fragment,{children:[h==="correct"&&e.jsx("span",{className:"feedback-icon correct",children:"âœ“"}),h==="incorrect"&&e.jsx("span",{className:"feedback-icon incorrect",children:"âœ—"})]})]},m)})}),u[t.id]!==void 0&&a==="practice"&&e.jsx("div",{className:"instant-feedback",children:u[t.id]===t.correctAnswer?e.jsxs("div",{className:"feedback correct-feedback",children:[e.jsx("span",{className:"feedback-icon",children:"âœ“"}),"Correct! Well done."]}):e.jsxs("div",{className:"feedback incorrect-feedback",children:[e.jsxs("div",{className:"feedback-content",children:[e.jsx("span",{className:"feedback-icon",children:"âœ—"}),e.jsx("span",{children:"Incorrect. The correct answer is:"})]}),e.jsxs("strong",{children:[String.fromCharCode(65+t.correctAnswer),". ",t.options[t.correctAnswer]]})]})})]},t.id))}),a==="practice"&&oe()&&O()&&e.jsxs("div",{className:"step-completion",children:[e.jsxs("div",{className:"completion-message",children:[e.jsx("span",{className:"completion-icon",children:"ðŸŽ‰"}),"Great job! You've completed this set of questions."]}),e.jsx("button",{className:"next-step-button",onClick:()=>f(t=>t+1),children:"Continue to Next Set â†’"})]}),e.jsxs("div",{className:"actions",children:[e.jsxs("button",{className:"btn btn-secondary",onClick:re,title:"Export quiz with correct answers",children:[e.jsx(ve,{size:18}),"Export Quiz"]}),e.jsx("button",{className:"generate-more-button",onClick:M,disabled:d,children:d?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"spinner"}),"Generating..."]}):e.jsxs(e.Fragment,{children:[e.jsx(K,{size:18}),"Generate More"]})})]})]}),e.jsx(Ne,{questions:r,userAnswers:u,isVisible:r.length>0})]})]})]})};export{Pe as default};
