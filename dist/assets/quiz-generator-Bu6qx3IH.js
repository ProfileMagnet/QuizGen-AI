const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./pdf-vendor-DhExmcWY.js","./components-BaayOLnC.js","./react-vendor-W4zfnjO4.js","./vendor-k7V_0J0F.js","./components-Bh9Sije7.css"])))=>i.map(i=>d[i]);
var ie=Object.defineProperty,oe=Object.defineProperties;var ce=Object.getOwnPropertyDescriptors;var M=Object.getOwnPropertySymbols;var le=Object.prototype.hasOwnProperty,de=Object.prototype.propertyIsEnumerable;var O=(a,o,s)=>o in a?ie(a,o,{enumerable:!0,configurable:!0,writable:!0,value:s}):a[o]=s,W=(a,o)=>{for(var s in o||(o={}))le.call(o,s)&&O(a,s,o[s]);if(M)for(var s of M(o))de.call(o,s)&&O(a,s,o[s]);return a},U=(a,o)=>oe(a,ce(o));var I=(a,o,s)=>new Promise((A,r)=>{var i=v=>{try{m(s.next(v))}catch(b){r(b)}},u=v=>{try{m(s.throw(v))}catch(b){r(b)}},m=v=>v.done?A(v.value):Promise.resolve(v.value).then(i,u);m((s=s.apply(a,o)).next())});import{r as p,j as e,b as ue,S as D,c as he,D as pe}from"./react-vendor-W4zfnjO4.js";import{_ as me,C as ge,L as xe,a as fe,I as je}from"./components-BaayOLnC.js";import"./vendor-k7V_0J0F.js";const ve=a=>I(null,null,function*(){const{default:o}=yield me(()=>I(null,null,function*(){const{default:d}=yield import("./pdf-vendor-DhExmcWY.js");return{default:d}}),__vite__mapDeps([0,1,2,3,4]),import.meta.url),s=new o,A=s.internal.pageSize.getWidth(),r=s.internal.pageSize.getHeight();let i=15;const u=15,m=A-u*2,v=5,b=4,c=(d,x,f,F,w=12)=>{s.setFontSize(w);const j=s.splitTextToSize(d,F);return s.text(j,x,f),f+j.length*v+2},C=d=>i+d>r-u?(s.addPage(),i=15,!0):!1;a.forEach(d=>{const x=30+d.options.length*10;C(x),s.setFontSize(11),s.setFont("helvetica","bold");const f=`${d.id}. ${d.question}`;i=c(f,u,i,m,11),i+=1,s.setFontSize(9),s.setFont("helvetica","normal"),d.options.forEach((F,w)=>{const k=`${String.fromCharCode(65+w)}) ${F}`;i=c(k,u+8,i,m-8,9)}),i+=b}),s.addPage(),i=15,s.setFontSize(16),s.setFont("helvetica","bold"),i=c("Answer Key",u,i,m,16),i+=10,s.setFontSize(11),s.setFont("helvetica","normal"),a.forEach(d=>{const x=String.fromCharCode(65+d.correctAnswer),f=`${d.id}. ${x}`;i=c(f,u,i,m,11),i+=2});const l=r-10;s.setFontSize(8),s.setFont("helvetica","italic"),s.text("QuizGen AI",u,l),s.text(new Date().toLocaleDateString(),A-u-30,l);const P=`quiz-${new Date().toISOString().split("T")[0]}.pdf`;s.save(P)}),ze=()=>{const[a,o]=p.useState(""),[s,A]=p.useState(""),[r,i]=p.useState([]),[u,m]=p.useState(!1),[v,b]=p.useState(!1),[c,C]=p.useState({}),[l,P]=p.useState("practice"),[d,x]=p.useState(0),[f]=p.useState(5),[F,w]=p.useState(!1),[j,k]=p.useState(""),[Y,R]=p.useState(""),[H,S]=p.useState(0),E=p.useRef(null),Q=p.useMemo(()=>r.map(t=>t.question),[r]),G=p.useCallback((t=!1)=>I(null,null,function*(){if(!a.trim()||!s.trim()){alert("Please provide both topic and Hugging Face API key");return}m(!0),E.current&&E.current.abort(),E.current=new AbortController;try{console.log("Making API request with:",{text:`Generate a quiz about: ${a}`,past_quiz_qns:Q,api_key:s.substring(0,10)+"..."});const n=new Promise((z,q)=>{setTimeout(()=>{q(new Error("Request timeout after 60 seconds"))},6e4)}),g=fetch("https://quiz-generator-from-text.onrender.com/create_quiz/",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},signal:E.current.signal,body:JSON.stringify({text:`Generate a quiz about: ${a}`,past_quiz_qns:Q,api_key:s})}),h=yield Promise.race([g,n]);if(console.log("Response status:",h.status),console.log("Response headers:",h.headers),!h.ok){const z=yield h.text();throw console.error("Error response:",z),h.status===401||h.status===403||z.includes("Unauthorized")?new Error("Invalid API key. Please check your Hugging Face API key and try again."):h.status===429?new Error("Rate limit exceeded. Please wait a moment and try again."):new Error(z||`Request failed with status ${h.status}`)}const y=yield h.json();if(console.log("API Response:",y),!y.quiz||!Array.isArray(y.quiz))throw console.error("Unexpected response format:",y),new Error("Invalid response format from API");const N=y.quiz.map((z,q)=>({id:t?r.length+q+1:q+1,question:z.question,options:z.options,correctAnswer:z.answer_index}));console.log("Normalized questions:",N),t?(i(z=>[...z,...N]),b(!0)):(i(N),x(0),C({}),P("practice"),b(!0)),S(0)}catch(n){if(console.error("Full error:",n),n instanceof Error&&n.name==="AbortError"){console.log("Request was aborted");return}if(n instanceof Error&&n.message==="Request timeout after 60 seconds"){H===0?(k("Request Taking Longer Than Expected"),R("The quiz generation is taking longer than expected. Would you like to retry?"),w(!0),S(1)):(k("Server Unresponsive"),R("The server appears to be down or taking too long to respond. Please try again later."),w(!0),S(0)),m(!1);return}if(n instanceof Error&&(n.message.includes("Invalid API key")||n.message.includes("Unauthorized"))){k("Invalid API Key"),R("The provided Hugging Face API key is invalid or unauthorized. Please check your key and try again."),w(!0),S(0),m(!1);return}if(n instanceof Error&&n.message.includes("Rate limit exceeded")){k("Rate Limit Exceeded"),R("You have exceeded the rate limit. Please wait a moment and try again."),w(!0),S(0),m(!1);return}k("Error Generating Quiz"),R(n instanceof Error?n.message:"An unexpected error occurred. Please try again."),w(!0),S(0)}finally{m(!1)}}),[a,s,r,H,Q]),B=()=>{w(!1),j!=="Invalid API Key"&&j!=="Rate Limit Exceeded"&&G(!1)},J=()=>{w(!1),S(0)},V=()=>{o(""),A(""),i([]),C({}),P("practice"),x(0),b(!1)},K=()=>{G(!0)},X=(t,n)=>{l!=="review"&&c[t]===void 0&&C(g=>U(W({},g),{[t]:n}))},Z=()=>{if(l==="review")return;window.confirm("Are you sure you want to reset all your answers? This action cannot be undone.")&&(C({}),x(0))},ee=()=>I(null,null,function*(){if(r.length!==0)try{yield ve(r)}catch(t){console.error("Failed to export PDF:",t)}}),te=(t,n)=>{const g=c[t],h=r.find(y=>y.id===t);return!h||g===void 0?"default":n===h.correctAnswer?"correct":n===g?"incorrect":"default"},_=()=>{const t=r.filter(n=>c[n.id]===n.correctAnswer).length;return{correct:t,total:r.length,percentage:Math.round(t/r.length*100)}},T=()=>{const t=d*f,n=t+f;return r.slice(t,n)},$=()=>Math.ceil(r.length/f),se=()=>T().filter(n=>c[n.id]!==void 0).length,ne=()=>{const t=T();return t.length>0&&t.every(n=>c[n.id]!==void 0)},re=r.length>0&&r.every(t=>c[t.id]!==void 0),L=()=>d<$()-1,ae=()=>d>0;return e.jsxs("div",{className:"quiz-generator-page",children:[e.jsx(ge,{isOpen:F,title:j,message:Y,onRetry:B,onCancel:J,retryText:j==="Invalid API Key"?"OK":"Retry",showRetry:j!=="Invalid API Key",type:j==="Invalid API Key"||j==="Rate Limit Exceeded"?"error":j==="Request Taking Longer Than Expected"?"warning":"info"}),u&&e.jsx(xe,{message:"Generating your quiz..."}),v&&e.jsx(fe,{onComplete:()=>b(!1),duration:4e3}),e.jsxs("div",{className:"container",children:[e.jsxs("div",{className:"quiz-header",children:[e.jsxs("button",{className:"back-button",onClick:()=>window.history.back(),children:[e.jsx(ue,{size:20}),"Home"]}),e.jsx("div",{className:"quiz-header-content",children:e.jsxs("h1",{className:"page-title",children:[e.jsx("img",{src:"/icon.png",alt:"QuizGen AI",className:"title-icon"}),"QuizGen AI"]})})]}),r.length===0?e.jsx("div",{className:"generator-form",children:e.jsxs("div",{className:"form-card",children:[e.jsx("h2",{children:"Create Your Quiz"}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"topic",children:"Topic"}),e.jsx("input",{type:"text",id:"topic",placeholder:"Enter a topic (e.g., JavaScript, History, Biology)",value:a,onChange:t=>o(t.target.value)})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"apiKey",children:"Hugging Face API Key"}),e.jsx("input",{type:"password",id:"apiKey",placeholder:"Enter your Hugging Face API key",value:s,onChange:t=>A(t.target.value)}),e.jsxs("small",{className:"form-help",children:["Get your API key from ",e.jsx("a",{href:"https://huggingface.co/settings/tokens",target:"_blank",rel:"noopener noreferrer",children:"Hugging Face Settings"})]})]}),e.jsx("button",{className:"generate-button",onClick:()=>G(!1),disabled:u||!a.trim()||!s.trim(),children:u?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"spinner"}),"Generating Quiz"]}):e.jsxs(e.Fragment,{children:[e.jsx(D,{size:20}),"Generate Quiz"]})})]})}):e.jsxs("div",{className:"quiz-results-container",children:[e.jsxs("div",{className:"quiz-results",children:[e.jsxs("div",{className:"results-header",children:[e.jsx("div",{className:"quiz-title-section",children:e.jsx("div",{className:`step-indicator ${l==="review"?"review-mode":""}`,children:l==="review"?e.jsxs(e.Fragment,{children:["All Questions Review",e.jsxs("span",{className:"step-progress",children:["(",Object.keys(c).length,"/",r.length," answered)"]})]}):e.jsxs(e.Fragment,{children:["Step ",d+1," of ",$(),e.jsxs("span",{className:"step-progress",children:["(",se(),"/",T().length," answered)"]})]})})}),e.jsxs("div",{className:"header-actions",children:[l==="practice"&&re&&e.jsx("button",{className:"review-button",onClick:()=>P("review"),children:"Review All Answers"}),l==="review"&&e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"review-button",onClick:()=>P("practice"),children:"Back to Practice"}),e.jsxs("div",{className:"score-display",children:["Score: ",_().correct,"/",_().total," (",_().percentage,"%)"]})]}),l==="practice"&&Object.keys(c).length>0&&e.jsxs("button",{className:"reset-all-button",onClick:Z,title:"Reset all answers",children:[e.jsx(he,{size:16}),"Reset Answers"]}),e.jsx("button",{className:"generate-more-button",onClick:K,disabled:u,children:u?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"spinner"}),"Generating..."]}):e.jsxs(e.Fragment,{children:[e.jsx(D,{size:18}),"Generate More"]})}),e.jsx("button",{className:"reset-button",onClick:V,children:"Create New Quiz"})]})]}),l==="practice"&&e.jsxs("div",{className:"step-navigation",children:[e.jsx("button",{className:"nav-button prev",onClick:()=>x(t=>t-1),disabled:!ae(),children:"â† Previous"}),e.jsx("div",{className:"step-dots",children:Array.from({length:$()},(t,n)=>e.jsx("button",{className:`step-dot ${n===d?"active":""} ${r.slice(n*f,(n+1)*f).every(g=>c[g.id]!==void 0)?"completed":""}`,onClick:()=>x(n),children:n+1},n))}),e.jsx("button",{className:"nav-button next",onClick:()=>x(t=>t+1),disabled:!L(),children:"Next â†’"})]}),e.jsx("div",{className:"quiz-questions",children:(l==="practice"?T():r).map(t=>e.jsxs("div",{className:"quiz-question-card",children:[e.jsxs("div",{className:"question-header",children:[e.jsx("span",{className:"question-number",children:t.id}),e.jsx("h3",{children:t.question})]}),e.jsx("div",{className:"question-options",children:t.options.map((n,g)=>{const h=te(t.id,g),y=c[t.id]===g,N=c[t.id]!==void 0;return e.jsxs("div",{className:`option ${h!=="default"?`option-${h}`:""} ${y?"selected":""} ${l==="practice"&&!N?"clickable":""} ${N?"disabled":""}`,onClick:()=>X(t.id,g),style:{cursor:l==="practice"&&!N?"pointer":"not-allowed",opacity:l==="practice"&&N&&!y?.6:1},children:[e.jsxs("span",{className:"option-letter",children:[String.fromCharCode(65+g),"."]}),e.jsx("span",{className:"option-text",children:n}),N&&l==="practice"&&y&&e.jsx("span",{className:"lock-indicator",title:"Answer locked - use Reset to change",children:"ðŸ”’"}),N&&l==="review"&&e.jsxs(e.Fragment,{children:[h==="correct"&&e.jsx("span",{className:"feedback-icon correct",children:"âœ“"}),h==="incorrect"&&e.jsx("span",{className:"feedback-icon incorrect",children:"âœ—"})]})]},g)})}),c[t.id]!==void 0&&l==="practice"&&e.jsx("div",{className:"instant-feedback",children:c[t.id]===t.correctAnswer?e.jsxs("div",{className:"feedback correct-feedback",children:[e.jsx("span",{className:"feedback-icon",children:"âœ“"}),"Correct! Well done."]}):e.jsxs("div",{className:"feedback incorrect-feedback",children:[e.jsxs("div",{className:"feedback-content",children:[e.jsx("span",{className:"feedback-icon",children:"âœ—"}),e.jsx("span",{children:"Incorrect. The correct answer is:"})]}),e.jsxs("strong",{children:[String.fromCharCode(65+t.correctAnswer),". ",t.options[t.correctAnswer]]})]})})]},t.id))}),l==="practice"&&ne()&&L()&&e.jsxs("div",{className:"step-completion",children:[e.jsxs("div",{className:"completion-message",children:[e.jsx("span",{className:"completion-icon",children:"ðŸŽ‰"}),"Great job! You've completed this set of questions."]}),e.jsx("button",{className:"next-step-button",onClick:()=>x(t=>t+1),children:"Continue to Next Set â†’"})]}),e.jsxs("div",{className:"actions",children:[e.jsxs("button",{className:"btn btn-secondary",onClick:ee,title:"Export quiz with correct answers",children:[e.jsx(pe,{size:18}),"Export Quiz"]}),e.jsx("button",{className:"generate-more-button",onClick:K,disabled:u,children:u?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"spinner"}),"Generating..."]}):e.jsxs(e.Fragment,{children:[e.jsx(D,{size:18}),"Generate More"]})})]})]}),e.jsx(je,{questions:r,userAnswers:c,isVisible:r.length>0})]})]})]})};export{ze as default};
